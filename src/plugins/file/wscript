from waftools.plugin import plugin

def plugin_configure(conf):
    test = conf.create(enumerator='function')
    test.function = 'fstatat'
    test.defines = ['_ATFILE_SOURCE']
    test.headers = ['fcntl.h', 'sys/stat.h']
    test.mandatory = False

    if test.run():
        conf.env['CCDEFINES_file'] += ['HAVE_FSTATAT']

    return True

configure, build = plugin('file', configure=plugin_configure, needs_lib=True)
